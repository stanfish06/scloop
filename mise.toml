[tools]
uv = "latest"

[env]
CPLUS_INCLUDE_PATH = "{{config_root}}/src/scloop/data"

[settings]
python.uv_venv_auto = true

[tasks.sync_full]
run = [
	"uv cache clean",
	"uv cache prune",
	"rm -rf .venv",
	"rm -rf dist",
	"rm -rf ./src/scloop.egg-info",
	"rm -f uv.lock",
	"find ./src -name '*.so'  -type f -delete",
    "uv sync",
    "uv build"
]

[tasks.sync]
run = [
    "uv sync",
    "uv build"
]

[tasks.format]
run = [
    "pyproject-fmt pyproject.toml",
    "uv run ruff format"
]

[tasks.info]
run = [
    "uv --version",
    "python --version",
	"echo $CPLUS_INCLUDE_PATH",
	"tree -L 3 -I '__pycache__|*.pyc|*.so|archive|m4ri|*~' src/scloop/"
]

[tasks.kernel]
run = "uv run ipython kernel install --name 'scLoop' --user"
